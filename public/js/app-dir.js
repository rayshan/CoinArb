// Generated by CoffeeScript 1.6.3
(function() {
  angular.module('app').directive('caNumDisplay', function($animate) {
    return {
      templateUrl: 'partials/ca-num-display.html',
      transclude: true,
      restrict: 'E',
      scope: {
        name: "@",
        type: "@",
        cur: "=",
        pre: "=",
        baseline: "=",
        baselineBest: "=",
        curId: "=",
        curBaseline: "=",
        preBaseline: "="
      },
      link: function(scope, ele, attrs) {
        var _numEle;
        _numEle = angular.element(ele[0].querySelector('.ca-main'));
        scope.getBaselineNameEng = function() {
          if (scope.baseline != null) {
            return scope.$parent.app.data[scope.baseline].displayNameEng;
          }
        };
        scope.show = function(input, equality) {
          return !isNaN(parseFloat(input)) && isFinite(input) && Math.abs(input) > equality;
        };
        scope.diff = function(cur, pre, pct) {
          if (pct === true) {
            return (cur - pre) / pre * 100;
          } else {
            return cur - pre;
          }
        };
        scope.diffBaseline = function(input, baseline) {
          if ((input != null) && (baseline != null)) {
            return Math.abs(input - baseline);
          }
        };
        scope.$on('tickerUpdate', function() {
          var c;
          if (scope.cur !== scope.pre && scope.show(scope.diff(scope.cur, scope.pre, true), 0.009)) {
            c = 'change';
            $animate.addClass(_numEle, c, function() {
              return $animate.removeClass(_numEle, c);
            });
          }
        });
      }
    };
  });

}).call(this);

/*
//@ sourceMappingURL=app-dir.map
*/
